<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="eu" xml:lang="eu"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hugo González González">
<meta name="keywords" content="TFG, Grade of Physics, Physics Lab, BEC">

<title>BEC simulazioa</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e4313fbd540256e77f908a333d521360.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Ez dago emaitzarik",
    "search-matching-documents-text": "bilatutako dokumentuak",
    "search-copy-link-title": "Kopiatu esteka bilatzeko",
    "search-hide-matches-text": "Ezkutatu gainontzeko emaitzak",
    "search-more-match-text": "emaitza gehigarria dokumentu honetan",
    "search-more-matches-text": "emaitza gehigarriak dokumentu honetan",
    "search-clear-button-title": "Garbitu",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Utzi",
    "search-submit-button-title": "Bidali",
    "search-label": "Bilatu"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Orri honetan</h2>
   
  <ul>
  <li><a href="#oinarrizko-teoria" id="toc-oinarrizko-teoria" class="nav-link active" data-scroll-target="#oinarrizko-teoria"><span class="header-section-number">1</span> Oinarrizko teoria</a>
  <ul class="collapse">
  <li><a href="#ez-uniforme-bose-gasak-t0k" id="toc-ez-uniforme-bose-gasak-t0k" class="nav-link" data-scroll-target="#ez-uniforme-bose-gasak-t0k"><span class="header-section-number">1.1</span> Ez-uniforme Bose gasak T=0K</a>
  <ul class="collapse">
  <li><a href="#gross-pitaevskii-ekuazioa-gpe" id="toc-gross-pitaevskii-ekuazioa-gpe" class="nav-link" data-scroll-target="#gross-pitaevskii-ekuazioa-gpe"><span class="header-section-number">1.1.1</span> Gross-Pitaevskii ekuazioa (GPE)</a></li>
  </ul></li>
  <li><a href="#thomas-fermi-limitea" id="toc-thomas-fermi-limitea" class="nav-link" data-scroll-target="#thomas-fermi-limitea"><span class="header-section-number">1.2</span> Thomas-Fermi limitea</a>
  <ul class="collapse">
  <li><a href="#bortex-interakzio-txikiko-bose-gasan" id="toc-bortex-interakzio-txikiko-bose-gasan" class="nav-link" data-scroll-target="#bortex-interakzio-txikiko-bose-gasan"><span class="header-section-number">1.2.1</span> Bortex interakzio txikiko Bose gasan</a></li>
  </ul></li>
  <li><a href="#superfluidotasuna" id="toc-superfluidotasuna" class="nav-link" data-scroll-target="#superfluidotasuna"><span class="header-section-number">1.3</span> Superfluidotasuna</a>
  <ul class="collapse">
  <li><a href="#landauren-irizpidea-superfluidotasunarentzako" id="toc-landauren-irizpidea-superfluidotasunarentzako" class="nav-link" data-scroll-target="#landauren-irizpidea-superfluidotasunarentzako"><span class="header-section-number">1.3.1</span> Landauren irizpidea superfluidotasunarentzako</a></li>
  <li><a href="#bose-einstein-kondentsatua-eta-superfluidotasuna" id="toc-bose-einstein-kondentsatua-eta-superfluidotasuna" class="nav-link" data-scroll-target="#bose-einstein-kondentsatua-eta-superfluidotasuna"><span class="header-section-number">1.3.2</span> Bose-Einstein kondentsatua eta superfluidotasuna</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">BEC simulazioa</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Egilea</div>
    <div class="quarto-title-meta-contents">
             <p>Hugo González González <a href="mailto:hgonzalez031@ikasle.ehu.eus" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Argitaratua</div>
    <div class="quarto-title-meta-contents">
      <p class="date">18 de febrero de 2026</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Laburpena</div>
    <p>This analysis provides … |</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Gako-hitzak</div>
    <p>TFG, Grade of Physics, Physics Lab, BEC</p>
  </div>
</div>

</header>


<section id="oinarrizko-teoria" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Oinarrizko teoria</h1>
<p>Atal hau <span class="citation" data-cites="Pitaevskii">(<a href="#ref-Pitaevskii" role="doc-biblioref">Pitaevskii eta Stringari 2016</a>)</span> liburuan oinarrituta dago. Aztertuko ditugu oinarrizko gauzak GPE ekuazioa ulertu ahal izateko.</p>
<section id="ez-uniforme-bose-gasak-t0k" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="ez-uniforme-bose-gasak-t0k"><span class="header-section-number">1.1</span> Ez-uniforme Bose gasak T=0K</h2>
<p>Ikertuko ditugu Bose gas diluituen dinamika.</p>
<section id="gross-pitaevskii-ekuazioa-gpe" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="gross-pitaevskii-ekuazioa-gpe"><span class="header-section-number">1.1.1</span> Gross-Pitaevskii ekuazioa (GPE)</h3>
<p>Elektromagnetismoan egiten dugun bezala, <span class="math inline">\(\hat{\Psi}(\mathbf{r}, t)\)</span> eremu eragilea eremu klasiko batekin, <span class="math inline">\(\Psi_0(\mathbf{r}, t)\)</span>, ordezkatuko dugu. Azken honi kondentsatuaren uhin-funtzioa edo ordena-parametroa deitzen zaio. Orain behar dugu ekuazio bat duena funtzio klasikoaren dinamika. Hau lortzeko gogoratu Heisemberg-en irudian hurrengo erlazioa bete behar duela <span class="math inline">\(\hat{\Psi}\)</span>:</p>
<p><span class="math display">\[
i\hbar \frac{\partial}{\partial t} \hat{\Psi}(\mathbf{r}, t) = [\hat{\Psi}(\mathbf{r}, t), \hat{H}]
\]</span></p>
<p><span id="eq-p1"><span class="math display">\[
= \left[ -\frac{\hbar^2 \nabla^2}{2m} + V_{ext}(\mathbf{r}, t) + \int \hat{\Psi}^\dagger(\mathbf{r}', t) V(\mathbf{r}' - \mathbf{r}) \hat{\Psi}(\mathbf{r}', t) d\mathbf{r}' \right] \hat{\Psi}(\mathbf{r}, t),
\tag{1}\]</span></span></p>
<p>non <span class="math inline">\(V_{ext}(\mathbf{r}, t)\)</span> kanpo-potentziala den eta <span class="math inline">\(V(\mathbf{r}' - \mathbf{r})\)</span></p>
<p>Aldaketa egin ahal izateko, Bornen hurbilketa bete beharko da. Honetarako <span class="math inline">\(V_{eff}\)</span> bete beharko ditu energia txikiko sakabanaketaren baldintzak eta <span class="math inline">\(\Psi_0\)</span> era motelean aldatuko da elkarrekintza-potentzialaren barrutian. Hau betetzen bada <span class="math inline">\(\mathbf{r'}\)</span> <span class="math inline">\(\mathbf{r}\)</span>-rekin aldatu dezakegu.</p>
<p><span id="eq-GPE"><span class="math display">\[
i\hbar \frac{\partial}{\partial t} \Psi(\mathbf{r}, t) = \left( -\frac{\hbar^2 \nabla^2}{2m} + V_{ext}(\mathbf{r}, t) + g|\Psi(\mathbf{r}, t)|^2 \right) \Psi(\mathbf{r}, t)
\tag{2}\]</span></span></p>
<p>non ordena-parametroa <span class="math inline">\(g = \int V_{eff} \; d\mathbf{r}\)</span> den. Hau s-wave sakabanaketaren <span class="math inline">\(a\)</span> parametroaren funtzioan jar dezakegu:</p>
<p><span id="eq-p3"><span class="math display">\[
g = \frac{4 \pi \hbar^2 a}{m}
\tag{3}\]</span></span></p>
<p>non <span class="math inline">\(a\)</span> s-uhinen sakabanatze-luzera den eta <span class="math inline">\(m\)</span> atomo baten masa.</p>
<p>Hau izango da Maxwell ekuazioen analogoa baina energia eta momentuaren erlazioa fotoiena izan beharrean De Brogliren erlazioa beteko dute.</p>
<p>Zenbait baldintza bete beharko dira <a href="#eq-GPE" class="quarto-xref">Ekuazioa&nbsp;2</a> erabili ahal izateko.</p>
<ul>
<li>BEC-a sortzeko partikula kopuru handia behar ditugu.</li>
<li>Temperatura txikia izatea behar dugu partikulen artean sortzen diren elkarrekintzak txikiak izateko.</li>
<li>Gure uhin funtzioa dago normalizatuta hurrengo moduan: <span class="math inline">\(\int |\Psi|^2 \; d\mathbf{r} = N\)</span></li>
<li>Ekuazioa bete egingo da <span class="math inline">\(\mathbf{r} \gg a\)</span> denean.</li>
</ul>
<p>Hau guztia betetzen bada, gasaren dentsitatea kondentzatuarenarekin bat etorriko da:</p>
<p><span id="eq-density"><span class="math display">\[
n(\mathbf{r}) = |\Psi(\mathbf{r})|^2
\tag{4}\]</span></span></p>
<p>Beste era bat izango da egoera estazionario bat inposatzen</p>
<p><span id="eq-p5"><span class="math display">\[
\delta \left[ -i\hbar \int \Psi^* \frac{\partial}{\partial t} \Psi \, d\mathbf{r}dt + \int E \, dt \right] = 0
\tag{5}\]</span></span></p>
<p>akzioari. Honekin izango dugun ekuazioa</p>
<p><span id="eq-p6"><span class="math display">\[
i\hbar \frac{\partial \Psi(\mathbf{r}, t)}{\partial t} = \frac{\delta E}{\delta \Psi^*(\mathbf{r}, t)}
\tag{6}\]</span></span></p>
<p>izango da, non energia funtzionalaren ordena-parametroa</p>
<p><span id="eq-p7"><span class="math display">\[
E = \int \left( \frac{\hbar^2}{2m}|\nabla\Psi|^2 + V_{ext}(\mathbf{r})|\Psi|^2 + \frac{g}{2}|\Psi|^4 \right) d\mathbf{r}
\tag{7}\]</span></span></p>
<p>Orain ikusiko ditugu <a href="#eq-GPE" class="quarto-xref">Ekuazioa&nbsp;2</a>-ren kontserbazio legeak. Lehenengo, kontuan izanda <span class="math inline">\(\int |\Psi|^2 \; d\mathbf{r} = N\)</span> dela, hau da, partikula kopurua konstante mantentzen dela. Beraz, <a href="#eq-GPE" class="quarto-xref">Ekuazioa&nbsp;2</a> <span class="math inline">\(\Psi^*\)</span>-rekin biderkatuz probabilitatearen kontserbazio legea lortzen da:</p>
<p><span id="eq-kontinuidad"><span class="math display">\[
\frac{\partial n}{\partial t} + \text{div}\mathbf{j} = 0
\tag{8}\]</span></span></p>
<p>non erabili dugun <a href="#eq-density" class="quarto-xref">Ekuazioa&nbsp;4</a> eta sartu dugun korronte dentsitatea:</p>
<p><span id="eq-korrontea"><span class="math display">\[
\mathbf{j}(\mathbf{r}, t) = -\frac{i\hbar}{2m} (\Psi^* \nabla \Psi - \Psi \nabla \Psi^*) = n \frac{\hbar}{m} \nabla S
\tag{9}\]</span></span></p>
<p>non <span class="math inline">\(S\)</span> ordena-parametroaren fasea den. Gogoratu, ordena-parametroa funtzio konplexua izanda honela idatzi dezakegula:</p>
<p><span id="eq-uf"><span class="math display">\[
\Psi(\mathbf{r},t) = \sqrt{n(\mathbf{r},t)}e^{i S(\mathbf{r},t)}.
\tag{10}\]</span></span></p>
<p>Ekuazio honetatik lortu ahal dugu zein den kondentsatuaren abiadura fasearen bitartez:</p>
<p><span id="eq-abiadura"><span class="math display">\[
\mathbf{v_s}(\mathbf{r},t) = \frac{\hbar}{m} \nabla S.
\tag{11}\]</span></span></p>
<p>Gainera, ikusi dezakegunez hau irrotazionala izango da, zentsua daukana, azkenean superfluido guztiek propietate hau erakusten baitute.</p>
<p>Jakinda energia ere kontserbatu egingo dela lortu ahal izango dugu momentu dentsitatearen ekuazioa.</p>
<p><span id="eq-momentu-kontserbazioa"><span class="math display">\[
m \frac{\partial j_i}{\partial t} + \frac{\partial \Pi_{ik}}{\partial x_k} = -n \frac{\partial V_{ext}}{\partial x_i},
\tag{12}\]</span></span></p>
<p>non</p>
<p><span id="eq-momentu-tentsorea"><span class="math display">\[
\Pi_{ik} = \frac{\hbar^2}{4m^2} \left[ \frac{\partial \Psi}{\partial x_i} \frac{\partial \Psi^*}{\partial x_k} - \Psi \frac{\partial^2 \Psi^*}{\partial x_i \partial x_k} + \text{c.c.} \right] + \frac{gn^2}{2} \delta_{ik},
\tag{13}\]</span></span></p>
<p>momentuaren fluxu tentsorea da. Ohartu, kanpo indar barik momentua kontserbatu egingo dela.</p>
<p>Erabilgarria da fasearentzako ekuazio bat lortzea. Hau lortzen da <a href="#eq-uf" class="quarto-xref">Ekuazioa&nbsp;10</a> <a href="#eq-GPE" class="quarto-xref">Ekuazioa&nbsp;2</a> sartuz:</p>
<p><span id="eq-S"><span class="math display">\[
\hbar \frac{\partial}{\partial t} S + \left( \frac{1}{2} m \mathbf{v}_s^2 + V_{ext} + gn - \frac{\hbar^2}{2m\sqrt{n}} \nabla^2 \sqrt{n} \right) = 0.
\tag{14}\]</span></span></p>
<p>Konturatu <a href="#eq-density" class="quarto-xref">Ekuazioa&nbsp;4</a> eta <a href="#eq-S" class="quarto-xref">Ekuazioa&nbsp;14</a> osatzen dutela ekuazio multzo bat analogoa dena GPE ekuazioarekin. <span class="math inline">\(\hbar\)</span> ekuazioan sartzen da dentsitatearen gradientearen bitartez, honi deitzen zaio “presio kuantikoa”.</p>
<p><a href="#eq-GPE" class="quarto-xref">Ekuazioa&nbsp;2</a>-ren soluzio geldikorra forma simple bat du</p>
<p><span id="eq-guf"><span class="math display">\[
\Psi(\mathbf{r},t) = \Psi_0(\mathbf{r}) e^{-\frac{i\mu t}{\hbar}}.
\tag{15}\]</span></span></p>
<p>Denboraren menpekotasuna potentzial kimikoa zehazten du</p>
<p><span id="eq-mu(E)"><span class="math display">\[
\mu = \frac{\partial E}{\partial N},
\tag{16}\]</span></span></p>
<p>guzti honekin Gross-Pitaevskii ekuazioa honela idatzi dezakegu</p>
<p><span id="eq-egonGPE"><span class="math display">\[
\left( -\frac{\hbar^2 \nabla^2}{2m} + V_{ext}(\mathbf{r}) + g|\Psi_0(\mathbf{r})|^2 - \mu \right) \Psi_0(\mathbf{r}) = 0,
\tag{17}\]</span></span></p>
<p>non suposatu egin dugu gure potentziala ez dela denboraren menpekoa. <span class="math inline">\(\mu\)</span>-ren balioa normalizazio baldintzak ezarriko digu.</p>
</section>
</section>
<section id="thomas-fermi-limitea" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="thomas-fermi-limitea"><span class="header-section-number">1.2</span> Thomas-Fermi limitea</h2>
<p><a href="#eq-S" class="quarto-xref">Ekuazioa&nbsp;14</a> ekuazioan ikusi dugu parte bat presio kuantiko modukoa izango dela. Honek bi zatitan banatu dezakegu: <span class="math inline">\(gn\)</span> interakzio partean eta Bohm-en potentzialean (<span class="math inline">\(Q\)</span>). Honen forma hurrengoa da:</p>
<p><span id="eq-Q"><span class="math display">\[
Q = - \frac{\hbar^2}{2m} \frac{\nabla^2 \sqrt{n}}{\sqrt{n}}.
\tag{18}\]</span></span></p>
<p>Thomas-Fermi limitean, <span class="math inline">\(\nabla^2 \sqrt{n}/\sqrt{n}\)</span> magnitudea berreskuratze luzera <span class="math inline">\(\xi = \hbar / \sqrt{2mgn}\)</span> (hau erakusten du noiz izango dugun kondentsatua a la ez, oso txikia, edo orden berekoa, bada sistemaren luzera karakteristikoa interakzioak eta gero ez du denborarik berreskuratzeko eta apurtzen da kondentsatua) baino askoz handiagoa bada (hau da, <span class="math inline">\(\sqrt{n}\)</span> oso era motelean aldatzen bada denbora eta espazioan zehar) <span class="math inline">\(Q\)</span> guztiz arbuiagarria izango da eta berridatz dezakegu <a href="#eq-S" class="quarto-xref">Ekuazioa&nbsp;14</a> abiadura eremu bat bezala:</p>
<p><span id="eq-TF"><span class="math display">\[
m \frac{\partial \mathbf{v}_s}{\partial t} + \nabla \left( \frac{1}{2}m\mathbf{v}_s^2 + V_{ext} + gn \right) = 0
\tag{19}\]</span></span></p>
<p>non ekuazio hau bat datorren Eulerren ekuazioarekin, fluido batentzat kanpo potentzial baten eraginean eta biskositate barik. Fluido honen presioa <span class="math inline">\(P = gn^2/2\)</span> eta soinuaren abiadura <span class="math inline">\(c=\sqrt{gn/m}\)</span>. Horretaz gain, berridatzi dezakegu <a href="#eq-kontinuidad" class="quarto-xref">Ekuazioa&nbsp;8</a> <span class="math inline">\(\mathbf{v}_s\)</span>-ren menpean</p>
<p><span id="eq-kontinuidad_vs_rho"><span class="math display">\[
\frac{\partial n}{\partial t} + \text{div}(v_sn) = 0,
\tag{20}\]</span></span></p>
<p>ekuazio bikote hauek hurrengo atalean ikusiko dugunez superfluido baten hidrodinamikari datorkie.</p>
<p>Thomas-Fermi hurbilketan oinarrizko egoerak forma erreza hartzen du, <span class="math inline">\(v_s = 0\)</span>. Hau da, energia zinetikoa guztiz arbuiatuz lortuko dugu. Era honetan izango dugu:</p>
<p><span id="eq-5.23"><span class="math display">\[
gn(\mathbf{r}) + V_{ext}(\mathbf{r}) = \mu
\tag{21}\]</span></span></p>
<p>non <span class="math inline">\(\mu\)</span> oinarrizko egoerari dagokion potentzial kimikoa den. Kanpo eremurik ez daukagunean ailegatzen gara Bogoliubov erlazioari <span class="math inline">\(\mu = gn\)</span></p>
<section id="bortex-interakzio-txikiko-bose-gasan" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="bortex-interakzio-txikiko-bose-gasan"><span class="header-section-number">1.2.1</span> Bortex interakzio txikiko Bose gasan</h3>
<p>Esan dugunez, GPE deskribatuta dago <a href="#eq-guf" class="quarto-xref">Ekuazioa&nbsp;15</a>-ren bitartez, hau da, magnitude orden bat denborarekiko menpekotasuna duena, non menpekotasuna fase global bat deskribatzen duen potentziak kimikoaren funtzioa dena.</p>
<p>Orain aztertuko ditugu bortez soluzioak. Hauek ematen dira gure kondentsatuaren dentsitatea zerorantz doanean. Hauek ematen diren eremuak, berreskuratze luzera baino txikiagoko eskualdetan gertatzen dira eta kontuan izan behar dugu presio kuantikoaren terminoa GPE-n.&nbsp;Normalean, azkar biratzen duen erreferentzia sisteman izango dira egonkorrak, sistema horretan energiaren funtzionala zero baita.</p>
<p>Superfluidoetan dauden biraketak ez dira solido zurrunean dauden bezalakoak <span class="math inline">\(\mathbf{v} = \mathbf{\Omega} \times \mathbf{r}\)</span>, baizik eta deskribatuta egongo da bortizitatea difusioarekin: <span class="math inline">\(\text{curl}\mathbf{v} = 2\mathbf{\Omega}\)</span>. Hau konturatzen bagara, kontraesan bat izango da superfluidoak irrotazionalak direla esan genuelako, hau da, espero dugu hauek ez biratzea solido zurruna bezala.</p>
<p>Demagun dugula <span class="math inline">\(R\)</span> erradioko eta <span class="math inline">\(L\)</span> luzerako zilindro batean gasa konfinatuta. Izango dugun soluzioa hurrengo formakoa izango da:</p>
<p><span id="eq-zuf"><span class="math display">\[
\Psi_0(\mathbf{r}) = e^{is\varphi}|\Psi_0(r)|,
\tag{22}\]</span></span></p>
<p>non sartu ditugun koordenatu zilindrikoak <span class="math inline">\(z\)</span>, <span class="math inline">\(r\)</span> eta <span class="math inline">\(\varphi\)</span>. <span class="math inline">\(s\)</span> zenbaki osoa da, gure uhin-funtzioa balio bakarra izan dezan. Konturatzen bagara <a href="#eq-zuf" class="quarto-xref">Ekuazioa&nbsp;22</a> <span class="math inline">\(l_z\)</span>-ren autobalioa izango da <span class="math inline">\(l_z = s \hbar\)</span> izaten. Beraz, bortex osoaren momentu angeluarra <span class="math inline">\(L_z = N s \hbar\)</span> izango da. <a href="#eq-zuf" class="quarto-xref">Ekuazioa&nbsp;22</a> adierazten du gas bat biratzen hurrengo abiadura tangentzialarekin</p>
<p><span id="eq-abiadura-tangen"><span class="math display">\[
v_s = \frac{\hbar}{m}\frac{s}{r}.
\tag{23}\]</span></span></p>
<p>Konturatzen bagara hau guztiz desberdina da solido zurrunean geneukanarekin, hau <span class="math inline">\(1/r\)</span>-ren proportzionala baita (<a href="#fig-vel-eremuak" class="quarto-xref">Irudia&nbsp;1</a>).</p>
<div id="cell-fig-vel-eremuak" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div id="fig-vel-eremuak" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vel-eremuak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Index_files/figure-html/fig-vel-eremuak-output-1.png" width="508" height="366" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vel-eremuak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Irudia&nbsp;1: Abiadura-eremu tangentziala fluxu irrotazionalerako (<span class="math inline">\(v_{\text{irr}}\)</span>) eta errotazio rigidoko (<span class="math inline">\(v_{\text{rig}}\)</span>) fluxurako. Abiadura-eremu irrotazionala <span class="math inline">\(1/r\)</span> bezala dibergitzen da <span class="math inline">\(r \to 0\)</span> denean. Hemen <span class="math inline">\(r\)</span> eta <span class="math inline">\(v\)</span> unitate arbitrarioetan (a.u.) neurtzen dira.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ordezkatuz <a href="#eq-zuf" class="quarto-xref">Ekuazioa&nbsp;22</a> <a href="#eq-egonGPE" class="quarto-xref">Ekuazioa&nbsp;17</a>, lortuko dugun adierazpena <span class="math inline">\(|\Psi_0|\)</span>-rentzat:</p>
<p><span id="eq-20"><span class="math display">\[
-\frac{\hbar^2}{2m} \frac{1}{r} \frac{d}{dr} \left( r \frac{d|\Psi_0|}{dr} \right) + \frac{\hbar^2 s^2}{2mr^2} |\Psi_0| + g|\Psi_0|^3 - \mu|\Psi_0| = 0.
\tag{24}\]</span></span></p>
<p>Bortexaren distantzia handietara dakigu izan behar dugun dentsitatea kondentsatuarena izango dela <span class="math inline">\(|\Psi_0| \to \sqrt{n}\)</span>. Hau dela eta, sartuko dugu hurrengo funtzio adimensionala <span class="math inline">\(f(\eta)\)</span> eta gure dentsitatea:</p>
<p><span id="eq-aduf"><span class="math display">\[
|\Psi_0| = \sqrt{n} f(\eta),
\tag{25}\]</span></span></p>
<p>non <span class="math inline">\(\eta = r/\xi\)</span> eta <span class="math inline">\(\xi = \hbar / \sqrt{2mgn}\)</span> berreskuratze luzera den. Funtzio honek betetzen duen ekuazioa</p>
<p><span id="eq-f"><span class="math display">\[
\frac{1}{\eta} \frac{d}{d\eta} \left( \eta \frac{df}{d\eta} \right) + \left( 1 - \frac{s^2}{\eta^2} \right) f - f^3 = 0,
\tag{26}\]</span></span></p>
<p>non muga baldintzak <span class="math inline">\(f(\eta\to\infty) = 1\)</span> eta <span class="math inline">\(f(0) = 0\)</span> izan behar diren. Hau numerikoki ebasten badugu ikusten da (<a href="#fig-bortex-profila" class="quarto-xref">Irudia&nbsp;2</a>) nola <span class="math inline">\(r\)</span> <span class="math inline">\(\xi\)</span>-ren ordenakoa denenean dentsitate aldaketa bortitza izango den.</p>
<div id="cell-fig-bortex-profila" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div id="fig-bortex-profila" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bortex-profila-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Index_files/figure-html/fig-bortex-profila-output-1.png" width="546" height="366" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bortex-profila-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Irudia&nbsp;2: <a href="#eq-f" class="quarto-xref">Ekuazioa&nbsp;26</a>-ren soluzio numerikoak <span class="math inline">\(s=1\)</span> eta <span class="math inline">\(s=2\)</span> kasuetarako. Ikusten da nola kondentsatuaren dentsitatea aldatzen den <span class="math inline">\(\eta\)</span>-ren funtzioan.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="superfluidotasuna" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="superfluidotasuna"><span class="header-section-number">1.3</span> Superfluidotasuna</h2>
<p>Aipatu dugunez, BEC-a superfluido baten moduan jokatzen du tenperatura kritiko bat baino hotsago dagoenean. Parte honetan eztabaidatuko ditugu Landauren superfluidoen hidrodinamika, eta nola teoria honek ahalbidetzen dituen aurkitutako ordena-parametroaren fasearen fluktuazioak BEC-aren teorian.</p>
<section id="landauren-irizpidea-superfluidotasunarentzako" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="landauren-irizpidea-superfluidotasunarentzako"><span class="header-section-number">1.3.1</span> Landauren irizpidea superfluidotasunarentzako</h3>
<p>Landauren superfluidoen teoria garatzeko, energiaren eta momentuaren transformazio Galilearrak erabiliko erabiliko ditugu. <span class="math inline">\(E\)</span> eta <span class="math inline">\(\mathbf{P}\)</span> izango dira energia eta momentua fluidoaren pausaguneko sisteman <span class="math inline">\(K\)</span>. Orduan <span class="math inline">\(K'\)</span> sisteman, <span class="math inline">\(\mathbf{v}\)</span> abiaduraz mugitzen dena <span class="math inline">\(K\)</span> sistemarekiko, energia eta momentuaren adierazpenak:</p>
<p><span id="eq-p8"><span class="math display">\[
E' = E - \mathbf{P.V} + \frac{1}{2} M V^2, \; \mathbf{P'} = \mathbf{P} - M \mathbf{v}
\tag{27}\]</span></span></p>
<p>non <span class="math inline">\(M\)</span> fluidoaren masa den.</p>
<p>Kontsidera dezagun fluido bat, kapilar baten zehar higitzen dena <span class="math inline">\(\mathbf{v}\)</span> abiadurarekin. Fluidoa biskositatea badu, galdutako energia modelizatu ahal dugu higitzen den pertubazio baten moduan. Perturbazio honen energia eta momentua fluidoaren pausaguneko sisteman <span class="math inline">\(\mathbf{p}\)</span> eta <span class="math inline">\(E_0 + \epsilon(\mathbf{p})\)</span> izango dira, non <span class="math inline">\(E_0\)</span> pertubazioaren oinarrizko energia den eta <span class="math inline">\(\epsilon(\mathbf{p})\)</span> kitzikapenak sortutako energia. Kapilarraren pausaguneko sisteman ikusiko dugu:</p>
<p><span id="eq-p9"><span class="math display">\[
E' = E_0 + \epsilon(\mathbf{p}) + \mathbf{p.v} + \frac{1}{2} M v^2, \mathbf{P'} = \mathbf{p} + M \mathbf{v}
\tag{28}\]</span></span></p>
<p><a href="#eq-p9" class="quarto-xref">Ekuazioa&nbsp;28</a> ikusi ahal dugu nola energia eta momentu aldaketak, kapilarraren pausaguneko sisteman, <span class="math inline">\(\epsilon(\mathbf{p}) + \mathbf{p.v}\)</span> eta <span class="math inline">\(\mathbf{p}\)</span> diren. Orduan, <span class="math inline">\(\epsilon(\mathbf{p}) + \mathbf{p.v}\)</span> negatiboa izan behar da berezko kitzikapena izateko. Hau posiblea izateko, <span class="math inline">\(v &gt; \epsilon(\mathbf{p}) / p\)</span> izan behar da. Suposatzen badugu <span class="math inline">\(\mathbf{p}\)</span> momentua kapilarrari transferitzen diola, hau bero moduan disipatu egingo da eta fluidoa ez da egonkorra izango. Baina abiadura,</p>
<p><span id="eq-vc"><span class="math display">\[
v_c = \text{min}_p \frac{\epsilon(\mathbf{p})}{p}
\tag{29}\]</span></span></p>
<p>baino txikiago bada, kitzikapenak ezin dira agertu. Hau da Landauren superfluidotasunaren baldintza.</p>
<p><span id="eq-LSC"><span class="math display">\[
v &lt; v_c
\tag{30}\]</span></span></p>
<p>Fluidoaren eta kapilarraren abiadura erlatiboak, <a href="#eq-vc" class="quarto-xref">Ekuazioa&nbsp;29</a> balio kritikoa baino txikiagoa bada. Orduna marruskadura gabeko fluxua izango dugu. Egoera honi, metaegonkorra deritzogu. Egonkorra da bat-bateko kitzikapenekiko.</p>
<p>Interakzio ahuleko Bose gasa Landauren irispidea betetzen du, non abiadura kritikoa soinuaren abiadura izango den. <span class="math inline">\(^4He\)</span>-ren kasuan ere beteko egingo du Landauren irispidea, baina kasu honetan abiadura kritikoa soinuaren abiadura baino txikiagoa izango da, <span class="math inline">\(^4He\)</span> partikulen elkarrekintza handiagoa baita.</p>
<p>Demagun temperatura txikia dela. Gure fluidoaren propietateak izango dira interakzio gabeko gas baten kitzikapenak (kuasipartikulak) oreka termikoan bezalakoak. kuasipartikulak dira sistemaren masaren parte bat garraiatzen dituztenak. Gainera, hauek talka egitean kapilarraren hormekin energia disipatu egingo dute, fluido normal baten moduan. Beraz, izango ditugu bi fase, bat normala <span class="math inline">\(\mathbf{v_n}\)</span>-rekin eta beste bat superfluidoa dena <span class="math inline">\(\mathbf{v_s}\)</span>, non abiadura hauek izango dira kapilarraren pausaguneko sistemarekiko. Orduan kitzikapenen energia <span class="math inline">\(\epsilon(\mathbf{p}) + \mathbf{p.}(\mathbf{v_s - v_n})\)</span>. Orekan dauden kitzikapenen, <span class="math inline">\(\mathbf{p}\)</span> banaketa funtzioa:</p>
<p><span id="eq-Np"><span class="math display">\[
N_{\mathbf{p}} = \left[ exp\left(\frac{\epsilon(\mathbf{p}) + \mathbf{p.} (\mathbf{v_s - v_n})}{k_B T}\right) - 1 \right]^{-1}
\tag{31}\]</span></span></p>
<p>Ekuazio hau betetzeko <span class="math inline">\(\mathbf{p}\)</span>-ren balio guztietarako (hau da, kitzikapenen energia positiboa izateko) <span class="math inline">\(|\mathbf{v_s} - \mathbf{v_n}|\)</span> abiadura kritikoa baino txikiagoa izan beharko da. Orduan, <span class="math inline">\(N_\mathbf{p}\)</span> beti izango da positiboa. Oreka termodinamikoan gaudenean, superfluido fasearen eta fase normalaren arteko marruskadurarik ez dago. Hau gertatzekotan, gero eta kitzikapen gehiago sortuko lirateke eta, ondorioz, superfluido fasea apurtuko zen.</p>
<p>Kontuan izanda bi faseak batera daudela, fluidoaren masa dentsitatea idatz dezakegu hurrengo moduan: <span class="math inline">\(\rho = \rho_n + \rho_s\)</span> (<span class="citation" data-cites="Pitaevskii">(<a href="#ref-Pitaevskii" role="doc-biblioref">Pitaevskii eta Stringari 2016</a>)</span> erabiltzen du <span class="math inline">\(\rho = n m\)</span> dentsitatea hemendik aurrera literatura orokorrean hau egiten baitenez, <span class="math inline">\(n\)</span> erabili beharrean). Likidoaren masa korrontea definitu dezakegu:</p>
<p><span id="eq-mj"><span class="math display">\[
m \mathbf{j} = \rho_s \mathbf{v_s} + \rho_n \mathbf{v_n}
\tag{32}\]</span></span></p>
<p>Hau erabili ahal dugu definitzeko fluido normalaren dentsitatea. Jar gaitezen superfluidoaren pausaguneko sisteman, orduan <span class="math inline">\(m\mathbf{j} = \rho_n \mathbf{v_n}\)</span> izango dugu. Beraz, likidoak dakarren momentu osoa <span class="math inline">\(\mathbf{P} = \sum_{\mathbf{p}} N_{\mathbf{p}} \mathbf{p}\)</span> izango da. Onekin, <a href="#eq-mj" class="quarto-xref">Ekuazioa&nbsp;32</a> berridatzi dezakegu:</p>
<p><span id="eq-intmj"><span class="math display">\[
m \mathbf{j} = \int \; \frac{d \mathbf{p}}{(2 \pi \hbar)^3} \mathbf{p} N_{\mathbf{p}}
\tag{33}\]</span></span></p>
<p>eta esan dugunez, superfluidoaren pausaguneko sisteman gaudenez</p>
<p><span id="eq-intrhov"><span class="math display">\[
\rho_n \mathbf{v_n} = \int \; \frac{d \mathbf{p}}{(2 \pi \hbar)^3} \mathbf{p} N_{\mathbf{p}}
\tag{34}\]</span></span></p>
<p>izango dugu. <span class="math inline">\(\mathbf{v_n}\)</span> txikia izango denez (oreka termikoan egoteko) <span class="math inline">\(N_{\mathbf{p}}\)</span> seriean garatu dezakegu termino linealerarte. Hau eginez, lortuko dugu fase normalaren masa dentsitatea</p>
<p><span id="eq-masadentitatea"><span class="math display">\[
\rho_n = - \frac{1}{3} \int \; \frac{d \mathbf{p}}{(2 \pi \hbar)^3} \frac{d N_{\mathbf{p}}(\epsilon)}{d \epsilon} p^2,
\tag{35}\]</span></span></p>
<p>isotropikoa izango dena <span class="math inline">\(\mathbf{p}\)</span>-rekiko. Oso erabilgarria da, kalkulatu ahal dugulako fase normalaren banaketa kitzikapenen funtzioen bitartez. Baina zenbait limite dauzkagu, <span class="math inline">\(N_{\mathbf{p}}\)</span> ez badago ondo definitua, desorden handia dogoenean, beste era bat bilatu beharko dugu kalkulatu ahal izateko fase normalaren dentsitatea.</p>
</section>
<section id="bose-einstein-kondentsatua-eta-superfluidotasuna" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="bose-einstein-kondentsatua-eta-superfluidotasuna"><span class="header-section-number">1.3.2</span> Bose-Einstein kondentsatua eta superfluidotasuna</h3>
<p>Orain nahi dugu BEC-aren eta superfluidoasunaren arteko erlazioa aztertu. Lehen egin dugun moduan, kondentsatuaren <span class="math inline">\(\Psi_0\)</span> uhin-funtzioaren propietateak aztertu nahi ditugu, transformazio Galilear bat egitean. Garrantzitsua da aipatzea, <span class="math inline">\(|\Psi_0|^2\)</span> dentsitatea uniformea izan arren, gure uhin-funtzioa ez da aldaezin bat izango transformazio Galilear batekiko fase bat gehitu beharko diogulako. Fase honen kalkulua egiteko erabili dezakegu <a href="#eq-p1" class="quarto-xref">Ekuazioa&nbsp;1</a>. Erreza da baieztatzea</p>
<p><span id="eq-phiGalilear"><span class="math display">\[
\hat{\Psi}' = \hat{\Psi}(\mathbf{r-v}t,t) \exp \left[ \frac{i}{\hbar} \left( m \mathbf{v.r} - \frac{1}{2} m v^2 t \right) \right],
\tag{36}\]</span></span></p>
<p>non <span class="math inline">\(\mathbf{v}\)</span> bektore konstante bat den, soluzio bat dela. Hau eremu eragilearen transformazio Galilearra da. ordena-parametroa eta bere itxarotako balio izango dute transformazio berbera. Dakigunez, gure fluidoa orekan dagoen erreferentzia sisteman, izango dugun uhin-funtzioa <span class="math inline">\(\Psi_0 = \sqrt{n_0} e^{-i \mu t / \hbar}\)</span>, non <span class="math inline">\(n_0\)</span> <span class="math inline">\(\mathbf{r}\)</span>-ren independiente den konstantea. Baina, fluidoa <span class="math inline">\(\mathbf{v}\)</span> abiadurarekin mugitzen den erreferentzia sisteman jarriz, lehen esan dugunez modulua es da aldatuko, fasea ez bezala. gure ordena-parametro berria <span class="math inline">\(\Psi_0 = \sqrt{n_0} e^{iS}\)</span> non gure fase berria</p>
<p><span id="eq-newphase"><span class="math display">\[
S(\sqrt{r},t) = \frac{1}{\hbar} \left[ m \mathbf{v.r} - \left( \frac{1}{2} m v^2 + \mu \right) t \right]
\tag{37}\]</span></span></p>
<p>izango den. Gainera, Hamilton-Jacobi ekuazio batetik hasi garenez (Schrödinger-en ekuazioa), dakigu gure superfluidoaren abiadura fasearen paraleloa izango dela:</p>
<p><span id="eq-superfluidVelocity"><span class="math display">\[
\mathbf{v}_s = \frac{\hbar}{m} \nabla S.
\tag{38}\]</span></span></p>
<p>Abiadura hau, era motelean aldatu ahal da denboran eta espazioan zehar. Gainera, guztiz orokorra da, ez baititugu inolako hurbilketak egin.</p>
<p><code>{{&lt; include SIMULACION/simulacion.qmd &gt;}}</code></p>



</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Erreferentziak</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Pitaevskii" class="csl-entry" role="listitem">
Pitaevskii, Lev, eta Sandro Stringari. 2016. <em>Bose-Einstein Condensation and Superfluidity</em>. Oxford University Press. <a href="https://doi.org/10.1093/acprof:oso/9780198758884.001.0001">https://doi.org/10.1093/acprof:oso/9780198758884.001.0001</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Aipamena</h2><div><div class="quarto-appendix-secondary-label">BibTeX Aipamenak:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{gonzález_gonzález2026,
  author = {González González, Hugo},
  title = {BEC simulazioa},
  date = {2026-02-18},
  langid = {eu},
  abstract = {This analysis provides ... \textbar{}}
}
</code><button title="Kopiatu Arbelean" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">Mesedez, aipa ezazu lan hau hurrengo eran:</div><div id="ref-gonzález_gonzález2026" class="csl-entry quarto-appendix-citeas" role="listitem">
González González, Hugo. 2026. <span>“BEC simulazioa.”</span> Grade of
Physics TFG, Bose-Einstein Condensation. February 18, 2026.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Kopiatuta!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Kopiatuta!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>