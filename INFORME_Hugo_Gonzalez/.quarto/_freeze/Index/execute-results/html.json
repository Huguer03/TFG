{
  "hash": "89e3602ff7d4d53c5514a457fe9e6add",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"BEC simulazioa\"\nauthor:\n  - name: \"Hugo González González\"\n    email: hgonzalez031@ikasle.ehu.eus\nkeywords:\n  - TFG\n  - Grade of Physics\n  - Physics Lab\n  - BEC\nabstract: |\n  This analysis provides ... |\n\nplain-language-summary: \n  \"...\"\nkey-points:\n  - BEC\n  - BEC\ndate: last-modified\nbibliography: references.bib\ncitation:\n  container-title: Grade of Physics TFG, Bose-Einstein Condensation\nnumber-sections: true\n\n---\n\n# ROADMAP TFG\n\nEsta guía organiza la lectura de los textos fundamentales para entender la física del Helio-II y cómo implementarla numéricamente en la librería **PyGPE** .\n\n\n\n## 1. Fundamentos Teóricos (La Ecuación de Gross-Pitaevskii)\n**Libro:** *Bose-Einstein Condensation and Superfluidity* - Pitaevskii & Stringari.\n\n* **Capítulo 5:** Secciones 5.1 y 5.3.\n * *Por qué:* Aquí se deriva la GPE y se define la **longitud de curación** ($\\xi$). Es la escala física que determinará el tamaño de tu rejilla (grid) en PyGPE.\n* **Capítulo 6:** Secciones 6.1 a 6.4.\n * *Por qué:* Explica la hidrodinámica cuántica. Aprenderás a extraer la velocidad del superfluido a partir del gradiente de la fase de la función de onda.\n* **Capítulo 8:** Superfluid $^4$He.\n * *Por qué:* Explica las particularidades del Helio-II frente a otros condensados, como la fuerte interacción entre átomos.\n\n\n\n## 2. Fenomenología de Vórtices (Lo que vas a simular)\n**Libro:** *Quantized Vortices in Helium II* - Russell J. Donnelly.\n\n* **Capítulo 4:** Estructura de los vórtices cuantizados.\n * *Por qué:* Describe el perfil de densidad del núcleo del vórtice. Es esencial para validar que tus resultados de PyGPE sean físicamente correctos.\n* **Capítulo 5:** Arreglos de vórtices (Vortex Lattices).\n * *Por qué:* Si simulas Helio en un recipiente rotante, este capítulo describe las redes de Abrikosov que deberías observar.\n\n\n\n## 3. Dinámica y Turbulencia (Tiempo Real)\n**Libro:** *Vortex Dynamics in Superfluid Helium-4* - Sergey K. Nemirovskii.\n\n* **Capítulo 2:** El modelo GPE para líneas de vórtice.\n * *Por qué:* Es el puente directo entre la teoría y la computación. Explica cómo la GPE permite que los vórtices se reconecten, algo fundamental en la turbulencia del Helio-II.\n* **Capítulo 4:** Dinámica de filamentos.\n * *Por qué:* Útil si planeas evolucionar el sistema en tiempo real para ver cómo interactúan los vórtices entre sí.\n\n\n\n## 4. Configuración Numérica en PyGPE\n\nPara que la simulación sea estable, debes seguir estas reglas de oro:\n\n1. **Resolución Espacial:** El espaciado entre puntos de tu malla (`dx`) debe cumplir:\n * $dx \\leq \\xi$ (lo ideal es $0.5\\xi$).\n2. **Tiempo Imaginario:** Usa siempre `find_ground_state()` primero para obtener una configuración inicial suave y de baja energía.\n3. **Tiempo Real:** Usa `evolve()` para estudiar fenómenos dinámicos como colisiones de vórtices o flujo a través de obstáculos.\n\n\n\n## 5. Resumen de Parámetros Físicos (Helio-II)\n\n| Parámetro | Símbolo | Valor Típico |\n| :--- | :--- | :--- |\n| Longitud de curación | $\\xi$ | $\\approx 1 \\times 10^{-10}$ m (1 Å) |\n| Masa del átomo | $m$ | $6.64 \\times 10^{-27}$ kg |\n| Quantum de circulación | $\\kappa$ | $h/m \\approx 9.97 \\times 10^{-8}$ m²/s |\n\n\n# Oinarrizko teoria\nParte hau dago osatuta [@pitaevskii2016] liburutik. Aztertuko ditugu oinarrizko gauzak GPE ekuazioa ulertu ahal izateko.\n\n## Ez uniforme Bose gasak T=0K\n\nIkertuko ditugu Bose gas diluituen dinamika.\n\n### Gross-Pitaevskii ekuazioa (GPE)\n\nElektromagnetismoan eginen dugun moduan, eremu eragilea $\\hat{\\Psi}(\\mathbf{r},t)$ eremu klasiko batekin $\\Psi_0(\\mathbf{r},t)$ (honi ere deitzen zaio kondentsatuaren uhin funtzioa edo ordenako parametroa) aldatuko dugu. Orain behar dugu ekuazio bat duena $\\Psi_0$ funtzio klasikoaren dinamika. Hau lortzeko gogoratu Heisemberg-en irudian hurrengo erlazioa bete behar duela $\\hat{\\Psi}$:\n\n$$\ni\\hbar \\frac{\\partial}{\\partial t} \\hat{\\Psi}(\\mathbf{r}, t) = [\\hat{\\Psi}(\\mathbf{r}, t), \\hat{H}]\n$$\n\n$$\n= \\left[ -\\frac{\\hbar^2 \\nabla^2}{2m} + V_{ext}(\\mathbf{r}, t) + \\int \\hat{\\Psi}^\\dagger(\\mathbf{r}', t) V(\\mathbf{r}' - \\mathbf{r}) \\hat{\\Psi}(\\mathbf{r}', t) d\\mathbf{r}' \\right] \\hat{\\Psi}(\\mathbf{r}, t),\n$${#eq-p1}\n\nAldaketa egin ahal izateko, Bornen hurbilketa bete beharko da. Honetarako $V_{eff}$ bete beharko ditu energia txikiko sakabanaketaren baldintzak eta $\\Psi_0$ era motelean aldatuko da elkarrekintza indarraren ahalmenean. Hau betetzen bada $\\mathbf{r'}$ $\\mathbf{r}$-rekin aldatu dezakegu. \n\n$$\ni\\hbar \\frac{\\partial}{\\partial t} \\Psi(\\mathbf{r}, t) = \\left( -\\frac{\\hbar^2 \\nabla^2}{2m} + V_{ext}(\\mathbf{r}, t) + g|\\Psi(\\mathbf{r}, t)|^2 \\right) \\Psi(\\mathbf{r}, t)\n$${#eq-GPE}\n\nordeneko parametroa $g = \\int V_{eff} \\; d\\mathbf{r}$-rekin. Hau s-wave sakabanaketaren $a$ parametroaren funtzioan jar dezakegu:\n\n$$\ng = \\frac{4 \\pi \\hbar^2 a}{m}\n$${#eq-p3}\n\nHau izango da Maxwell ekuazioen analogoa baina energia eta momentuaren erlazioa fotoiena izan beharrean De Brogliren erlazioa beteko dute.\n\nZenbait gauza bete beharko dira @eq-GPE erabili ahal izateko.\n\n* BCE-a sortzeko partikula kopuru handia behar ditugu.\n* Temperatura txikia izatea behar dugu partikulen artean sortzen diren elkarrekintzak txikiak izateko.\n* Gure uhin funtzioa dago normalizatuta hurrengo moduan: $\\int |\\Psi|^2 \\; d\\mathbf{r} = N$\n* Ekuazioa bete egingo da $\\mathbf{r} \\gg a$ denean.\n\nHau guztia betetzen bada, gasaren dentsitatea kondentzatuarenarekin bat etorriko da:\n\n$$\nn(\\mathbf{r}) = |\\Psi(\\mathbf{r})|^2\n$${#eq-density}\n\nBeste era bat izango da egoera estazionario bat inposatzen\n\n$$\n\\delta \\left[ -i\\hbar \\int \\Psi^* \\frac{\\partial}{\\partial t} \\Psi \\, d\\mathbf{r}dt + \\int E \\, dt \\right] = 0\n$${#eq-p5}\n\nakzioari. Honekin izango dugun ekuazioa\n\n$$\ni\\hbar \\frac{\\partial \\Psi(\\mathbf{r}, t)}{\\partial t} = \\frac{\\delta E}{\\delta \\Psi^*(\\mathbf{r}, t)}\n$${#eq-p6}\n\nizango da, non energia funtzionalaren orden parametroa\n\n$$\nE = \\int \\left( \\frac{\\hbar^2}{2m}|\\nabla\\Psi|^2 + V_{ext}(\\mathbf{r})|\\Psi|^2 + \\frac{g}{2}|\\Psi|^4 \\right) d\\mathbf{r}\n$${#eq-p7}\n\nOrain ikusiko ditugu [@eq-GPE]-ren kontserbazio legeak. Lehenengo, kontuan izanda $\\int |\\Psi|^2 \\; d\\mathbf{r} = N$ dela, hau da, partikula kopurua konstante mantenduko dela. Beraz, [@eq-GPE] $\\Psi^*$-rekin biderkatuz lortuko dugu hurrengo probabilitatearen kontserbazioaren legea lortzen da.\n\n$$\n\\frac{\\partial n}{\\partial t} + \\text{div}\\mathbf{j} = 0\n$${#eq-kontinuidad}\n\nnon erabili dugun [@eq-density] eta sartu dugun korronte dentsitatea:\n\n$$\n\\mathbf{j}(\\mathbf{r}, t) = -\\frac{i\\hbar}{2m} (\\Psi^* \\nabla \\Psi - \\Psi \\nabla \\Psi^*) = n \\frac{\\hbar}{m} \\nabla S\n$${#eq-korrontea}\n\nnon $S$ orden parametroaren fasea den. Gogoratu, orden parametroa funtzio konplexua izanda honela idatzi dezakegula:\n\n$$\n\\Psi(\\mathbf{r},t) = \\sqrt{n(\\mathbf{r},t)}e^{i S(\\mathbf{r},t)}.\n$${#eq-uf}\n\nEkuazio honetatik lortu ahal dugu zein den kondentsatuaren abiadura fasearen bitartez\n\n$$\n\\mathbf{v_s}(\\mathbf{r},t) = \\frac{\\hbar}{m} \\nabla S\n$${#eq-abiadura}\n\ngainera ikusi dezakegunez hau irrotazionala izango da, zentsua daukana, azkenean superfluido guztiek propietate hau erakusten baitute.\n\nJakinda energia ere kontserbatu egingo dela lortu ahal izango dugu momentu dentsitatearen ekuazioa.\n\n$$\nm \\frac{\\partial j_i}{\\partial t} + \\frac{\\partial \\Pi_{ik}}{\\partial x_k} = -n \\frac{\\partial V_{ext}}{\\partial x_i},\n$${#eq-momentu-kontserbazioa}\n\nnon\n\n$$\n\\Pi_{ik} = \\frac{\\hbar^2}{4m^2} \\left[ \\frac{\\partial \\Psi}{\\partial x_i} \\frac{\\partial \\Psi^*}{\\partial x_k} - \\Psi \\frac{\\partial^2 \\Psi^*}{\\partial x_i \\partial x_k} + \\text{c.c.} \\right] + \\frac{gn^2}{2} \\delta_{ik},\n$${#eq-momentu-tentsorea}\n\nmomentuaren fluxu tentsorea da. Ohartu, kanpo indar barik momentua kontserbatu egingo dela.\n\nErabilgarria da lortzea ekuazio bat fasearentzat, hau lortzen da [@eq-uf] [@eq-GPE] sartzen\n\n$$\n\\hbar \\frac{\\partial}{\\partial t} S + \\left( \\frac{1}{2} m \\mathbf{v}_s^2 + V_{ext} + gn - \\frac{\\hbar^2}{2m\\sqrt{n}} \\nabla^2 \\sqrt{n} \\right) = 0.\n$${#eq-S}\n\nKonturatu [@eq-density] eta [@eq-S] osatzen dutela ekuazio multzo bat analogoa dena GPE ekuazioarekin. $\\hbar$ ekuazioan sartzen da dentsitatearen gradientearen bitartez, honi deitzen zaio \"presio kuantikoa\".\n\n[@eq-GPE]-ren soluzio geldikorra forma simple bat du\n\n$$\n\\Psi(\\mathbf{r},t) = \\Psi_0(\\mathbf{r}) e^{-\\frac{i\\mu t}{\\hbar}}.\n$${#eq-guf}\n\nDenboraren menpekotasuna potentzial kimikoa zehazten du\n\n$$\n\\mu = \\frac{\\partial E}{\\partial N},\n$${#eq-mu(E)}\n\nguzti honekin Gross-Pitaevskii ekuazioa honela idatzi dezakegu\n\n$$\n\\left( -\\frac{\\hbar^2 \\nabla^2}{2m} + V_{ext}(\\mathbf{r}) + g|\\Psi_0(\\mathbf{r})|^2 - \\mu \\right) \\Psi_0(\\mathbf{r}) = 0,\n$${#eq-egonGPE}\n\nnon suposatu egin dugu gure potentziala ez dela denboraren menpekoa. $\\mu$-ren balioa normalizazio baldintzak ezarriko digu.\n\n### Bortex zuzenak interakzio txikiko Bose gasan\n\nEsan dugunez, GPE deskribatuta dago [@eq-guf]-ren bitartez, hau da, magnitude orden bat denborarekiko menpekotasuna duena, non menpekotasuna fase global bat deskribatzen duen potentziak kimikoaren funtzioa dena.\n\nOrain aztertuko ditugu bortez soluzioak. Hauek ematen dira gure kondentsatuaren dentsitatea zerorantz doanean. Hauek ematen diren eremuak, berreskuratze distantzia baino txikiagoko eskualdetan gertatzen dira eta kontuan izan behar dugu presio kuantikoaren terminoa GPE-n. Normalean, azkar biratzen duen erreferentzia sisteman izango dira egonkorrak, sistema horretan energiaren funtzionala zero baita.\n\nSuperfluidoetan dauden biraketak ez dira solido zurrunean dauden bezalakoak $\\mathbf{v} = \\mathbf{\\Omega} \\times \\mathbf{r}$, baizik eta deskribatuta egongo da bortizitatea difusioarekin: $\\text{curl}\\mathbf{v} = 2\\mathbf{\\Omega}$. Hau konturatzen bagara, kontraesan bat izango da superfluidoak irrotazionalak direla esan genuelako, hau da, espero dugu hauek ez biratzea solido zurruna bezala.\n\nDemagun daukagula $R$ erradioko eta $L$ luzerako zilindro batean gasa konfinatuta. Izango dugun soluzioa hurrengo formakoa izango datos\n\n$$\n\\Psi_0(\\mathbf{r}) = e^{is\\varphi}|\\Psi_0(r)|,\n$${#eq-zuf}\n\nnon sartu ditugun koordenatu zilindrikoak $z$, $r$ eta $\\varphi$. $s$ dago gure uhin funtzioak balio bakarra izateko. Konturatzen bagara [@eq-zuf] $l_z$-ren autobalioa izango da $l_z = s \\hbar$ izaten. Beraz, bortex osoaren lomentu angeluarra $L_z = N s \\hbar$ izango da. [@eq-zuf] adierazten du gas bat biratzen hurrengo abiadura tangentzialarekin\n\n$$\nv_s = \\frac{\\hbar}{m}\\frac{s}{r}.\n$${#eq-abiadura-tangen}\n\nKonturatzen bagara hau guztiz desberdina da solido zurrunean geneukanarekin, hau $1/r$-ren proportzionala baita ([@fig-vel-eremuak]).\n\n::: {#cell-fig-vel-eremuak .cell execution_count=1}\n\n::: {.cell-output .cell-output-display}\n![Abiadura-eremu tangentziala fluxu irrotazionalerako ($v_{\\text{irr}}$) eta errotazio rigidoko ($v_{\\text{rig}}$) fluxurako. Abiadura-eremu irrotazionala $1/r$ bezala dibergitzen da $r \\to 0$ denean. Hemen $r$ eta $v$ unitate arbitrarioetan (a.u.) neurtzen dira.](Index_files/figure-html/fig-vel-eremuak-output-1.png){#fig-vel-eremuak}\n:::\n:::\n\n\nOrdezkatuz [@eq-zuf] [@eq-egonGPE], lortuko dugun adierazpena $|\\Psi_0|$:\n\n$$\n-\\frac{\\hbar^2}{2m} \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{d|\\Psi_0|}{dr} \\right) + \\frac{\\hbar^2 s^2}{2mr^2} |\\Psi_0| + g|\\Psi_0|^3 - \\mu|\\Psi_0| = 0.\n$${#eq-20}\n\nBortexaren distantzia handietara dakigu izan behar dugun dentsitatea kondentsatuarena izango dela $|\\Psi_0| \\to \\sqrt{n}$. Hau dela eta, sartuko dugu hurrengo funtzio adimensionala $f(\\eta)$ eta gure dentsitatea:\n\n$$\n|\\Psi_0| = \\sqrt{n} f(\\eta),\n$${#eq-aduf}\n\nnon $\\eta = r/\\xi$ eta $\\xi = \\hbar / \\sqrt{2mgn}$ berreskuratze luzera. Funtzio honek betetzen duen ekuazioa\n\n$$\n\\frac{1}{\\eta} \\frac{d}{d\\eta} \\left( \\eta \\frac{df}{d\\eta} \\right) + \\left( 1 - \\frac{s^2}{\\eta^2} \\right) f - f^3 = 0,\n$${#eq-f}\n\nnon muga baldintzak $f(\\eta\\to\\infty) = 1$ eta $f(0) = 0$ izan behar diren. Hau numerikoki ebasten badugu ikusten da ([@fig-bortex-profila]) nola $r$-ren ordenekoa denean izango dugun aldaketa dentsitatean bortitza izango dentsitatean\n\n::: {#cell-fig-bortex-profila .cell execution_count=2}\n\n::: {.cell-output .cell-output-display}\n![[@eq-f]-ren soluzio numerikoak $s=1$ eta $s=2$ kasuetarako. Ikusten da nola kondentsatuaren dentsitatea aldatzen den $\\eta$-ren funtzioan.](Index_files/figure-html/fig-bortex-profila-output-1.png){#fig-bortex-profila}\n:::\n:::\n\n\n# Spin-1 Kondentsatuaren Simulazio Txostena: Trampa Harmonikoa\n\nTxosten honek `armonico.py` script-aren funtzionamendua zehazten du. Script honek spin-1 motako Bose-Einstein kondentsatu baten (BEC) fisika simulatzen du **pyGPE** liburutegia erabiliz. Helburu nagusia sistemaren **oinarrizko egoera** (ground state) aurkitzea da denbora imaginarioaren metodoaren bidez.\n\n## 1. Liburutegiak eta Azpiegitura\n* **Kalkulu Motorra**: Kodeak automatikoki detektatzen du GPU bat erabilgarri dagoen `cupy` erabiltzeko; bestela, `numpy` erabiltzen du CPU bidezko kalkuluetarako.\n* **Nukleo Fisikoa**: `pygpe.spinone` modulua erabiltzen du uhin-funtzioaren hiru osagaien dinamika kudeatzeko: $\\psi_+$, $\\psi_0$ eta $\\psi_-$.\n* **Ikusaraztea**: `matplotlib` erabiltzen du dentsitate eta fase mapak sortzeko.\n* **Prozesuaren Jarraipena (tqdm)**: `tqdm` liburutegia erabiltzen da simulazioaren begiztan egoera-barra bat erakusteko (programa orokorrean dago, baina txosten honetan kendu dugu). Honek kalkuluen progresioa, abiadura eta geratzen den denbora estimatua denbora errealean ikusteko aukera ematen du.\n\n::: {#f7089dbb .cell execution_count=3}\n``` {.python .cell-code}\nimport tqdm\ntry:\n    import cupy as cp  # type: ignore\nexcept ImportError:\n    import numpy as cp\nfrom pygpe.shared.utils import handle_array\nimport matplotlib.pyplot as plt\nimport pygpe.shared.vortices as vort\nimport pygpe.spinone as gpe\n```\n:::\n\n\n## 2. Normalizazio Globalerako Funtzioa\n**Denbora imaginarioaren** metodoak ez du uhin-funtzioaren norma kontserbatzen (egoera kitzikatuak iragazteko gutxitu egiten du), beraz, `global_normalize` funtzioa ezartzen da:\n* Dentsitate osoa kalkulatzen du hiru osagaiak batuz: $n = |\\psi_+|^2 + |\\psi_0|^2 + |\\psi_-|^2$.\n* Osagaiak eskalatze-faktore baten bidez doitzen ditu, dentsitatearen integrala partikula kopuru osoarekin ($N$) bat datorrela ziurtatzeko.\n\n::: {#e0511775 .cell execution_count=4}\n``` {.python .cell-code}\ndef global_normalize(psi, dx, dy, target_norm):\n    # Calcular densidad total\n    density = cp.abs(psi.plus_component)**2 + cp.abs(psi.zero_component)**2 + cp.abs(psi.minus_component)**2\n\n    # Calcular integral (número total de partículas)\n    current_norm = cp.sum(density) * dx * dy\n\n    if abs(current_norm - target_norm) > 1e-16:\n        factor = cp.sqrt(target_norm / current_norm)\n        # Aplicar a todas las componentes\n        psi.plus_component *= factor\n        psi.zero_component *= factor\n        psi.minus_component *= factor\n    return psi\n```\n:::\n\n\n## 3. Sistemaren Konfigurazioa\n* **Sarea (Grid)**: $128 \\times 128$ puntuko sare bat definitzen da, $0.5$ unitateko espazio-tartearekin.\n\n::: {#54fc81f3 .cell execution_count=5}\n``` {.python .cell-code}\n# Sortu sarea\npoints=(128,128)\nN = points[0]*points[1]\ngrid_spacing=(0.5,0.5)\ngrid = gpe.Grid(points, grid_spacing)\n\n# Trampa harmonikoa\nomega = 2\ntrap_strength = omega**2\n```\n:::\n\n\n* **Trampa Harmonikoa**: Potentzial paraboliko bat aplikatzen da: $V(x,y) = \\frac{1}{2} \\omega^2 (x^2 + y^2)$, non $\\omega = 2$.\n* **Parametro Fisikoak (`params`)**:\n    * `c0 = 100.0`: Dentsitatearen arteko interakzio repulsiboa.\n    * `c2 = -10.0`: Spin interakzio ferromagnetikoa (Helio-4 metaestagarriaren antzekoa).\n    * `q = 0.001`: Zeeman efektu koadratikoa, egonkortasun numerikoa emateko.\n    * `dt = -1j * 1e-2`: **Denbora imaginarioaren** pausoa sistemaren erlaxaziorako.\n\n::: {#01a1a78c .cell execution_count=6}\n``` {.python .cell-code}\n# Parametroak\nparams = {\n    # Interacciones (Basadas en longitudes de dispersión del Helio-4 metaestable)\n    \"c0\": 100.0,   # Interacción de densidad (repulsiva, mantiene el condensado unido)\n    \"c2\": -10.0,   # Interacción de spin (NEGATIVA para Helio = Ferromagnético)\n    # Campos externos\n    \"p\": 0.0,      # Zeeman lineal (usualmente 0 a menos que haya gradiente)\n    \"q\": 0.001,    # Zeeman cuadrático (pequeño pero positivo para estabilidad numérica)\n    # Trampa armonica\n    \"trap\": trap_strength, \n    \"n0\": 1.0,     \n    \"dt\": -1j * 1e-2, \n    \"nt\": 10000,\n    \"t\": 0,\n}\n```\n:::\n\n\n## 4. Hasieratzea eta Bilakaera\n1. **Hasierako Egoera**: Konfigurazio ferromagnetiko puru batetik abiatzen da: $\\psi = (1, 0, 0)^T$.\n2. **Zzarata eta Bortexa**: Zarata gehitzen zaio simetria hausteko eta fase-profil bat aplikatzen da bortex bat sorrarazteko.\n3. **Simulazio Buklea**: Programak $10.000$ iterazio egiten ditu. 10 urrats bakoitzean, datuak gordetzen dira eta sistema normalizatzen da energia minimorantz konbergitzen duela ziurtatzeko.\n\n::: {#0a3124c9 .cell execution_count=7}\n``` {.python .cell-code}\n# Sortu uhin funtzioa\npsi = gpe.SpinOneWavefunction(grid)\n\npsi.set_ground_state(\"ferromagnetic\", params)\npsi.add_noise(\"all\", 0.0, 1e-2)\n\n# Bortexak sortu\nphase = vort.vortex_phase_profile(grid, 100, 1)\npsi.apply_phase(phase)\n\npsi = global_normalize(psi, grid_spacing[0], grid_spacing[1],N)\n\ndata = gpe.DataManager(\"spin_one_data.hdf5\", \"SIMULACION/data\", psi, params) # Normalean hau ez da beharreskoa baina funtzionatzeko Quarton pth guztia jarri behar da.\n\npsi.fft() # Preparar el k espacio\nfor i in range(params[\"nt\"]):\n    # Perform the evolution\n    gpe.step_wavefunction(psi, params)\n    if i % 10 == 0:  # Save data every 10 time steps\n        psi = global_normalize(psi, grid_spacing[0], grid_spacing[1],N) # En el metodo de tiempo imaginario es recomendable renormalizar periodicamente\n        data.save_wavefunction(psi)\n    params[\"t\"] += params[\"dt\"]\n\npsi = global_normalize(psi, grid_spacing[0], grid_spacing[1],N)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAttempting to find 100 positions...\nSuccessfully found 100 positions in 100 iterations!\n```\n:::\n:::\n\n\n## 5. Emaitzen Analisia\nScript-ak lau paneleko irudi bat sortzen du:\n* **Dentsitate Osoa**: Kondentsatua tranparen erdian nola metatzen den erakusten du.\n\n::: {#aefa2f2f .cell execution_count=8}\n``` {.python .cell-code}\ndensity = cp.abs(psi.plus_component)**2 + cp.abs(psi.zero_component)**2 + cp.abs(psi.minus_component)**2\n\nn = cp.sum(density)/N\nn_max = cp.max(density)\nn_min = cp.min(density)\n\nprint(f\"·Partikula dentzitatea n={n}\\n·Partikula dentzitate maximoa nmax={n_max}\\n·Partikula dentzitate minimoa nmin={n_min}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n·Partikula dentzitatea n=4.0\n·Partikula dentzitate maximoa nmax=4.002224138940347\n·Partikula dentzitate minimoa nmin=3.9087265935901794\n```\n:::\n:::\n\n\n* **Faseak ($m_s = 1, 0, -1$)**: Osagai bakoitzaren tokiko fasea erakusten duten hiru mapa. Kolore-aldaketa zirkularrek bortexen egitura topologikoa adierazten dute.\n\n::: {#814ed883 .cell execution_count=9}\n``` {.python .cell-code}\n# Plot density and phase of zero component\nfig, ax = plt.subplots(2, 2, figsize=(12, 5))\n\n# Graficar Densidad\nim0 = ax[0,0].pcolormesh(\n    handle_array(grid.x_mesh),\n    handle_array(grid.y_mesh),\n    handle_array(density/n_max),\n    shading='auto'\n)\nax[0,0].set_title(r\"Densidad $|\\psi_0|^2 / n$\")\nax[0,0].set_ylabel(r\"$y$\")\nfig.colorbar(im0, ax=ax[0,0])\n\n# Graficar Fase spin up\nim1 = ax[0,1].pcolormesh(\n    handle_array(grid.x_mesh),\n    handle_array(grid.y_mesh),\n    handle_array(cp.angle(psi.plus_component)),\n    cmap=\"jet\",\n    shading='auto'\n)\nax[0,1].set_title(r\"Fase $m_s = 1$\")\nfig.colorbar(im1, ax=ax[0,1])\n\n# Graficar Fase spin cero\nim2 = ax[1,0].pcolormesh(\n    handle_array(grid.x_mesh),\n    handle_array(grid.y_mesh),\n    handle_array(cp.angle(psi.zero_component)),\n    cmap=\"jet\",\n    shading='auto'\n)\nax[1,0].set_title(r\"Fase $m_s = 0$\")\nax[1,0].set_ylabel(r\"$y$\")\nax[1,0].set_xlabel(r\"$x$\")\nfig.colorbar(im2, ax=ax[1,0])\n\n# Graficar Fase spin minus\nim3 = ax[1,1].pcolormesh(\n    handle_array(grid.x_mesh),\n    handle_array(grid.y_mesh),\n    handle_array(cp.angle(psi.minus_component)),\n    cmap=\"jet\",\n    shading='auto'\n)\nax[1,1].set_title(r\"Fase $m_s = -1$\")\nax[1,1].set_xlabel(\"x\")\nfig.colorbar(im3, ax=ax[1,1])\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](Index_files/figure-html/cell-10-output-1.png){}\n:::\n:::\n\n\n",
    "supporting": [
      "Index_files"
    ],
    "filters": [],
    "includes": {}
  }
}